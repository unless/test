name: 💿 St1_hook
on:
  workflow_dispatch:
    inputs:
      network_settings:
        description: "请选择初始网络配置"
        required: true
        default: 'static'
        type: choice
        options:
          - 'static'
          - 'dhcp'
      ipaddr:
        description: '请输入管理IP（静态地址时必填）'
        required: true
        default: '192.168.111.1'
      gateway:
        description: '请输入默认网关（静态地址时必填）'
        required: true
        default: '192.168.5.1'
      include_docker:
        description: "是否集成Docker插件"
        required: true
        default: 'yes'
        type: choice
        options:
          - 'yes'
          - 'no'
      ib_Version:
        description: '请选择需要的版本'
        required: false
        default: 'new'
        type: choice
          - '2025-10-19'
        options:
          - 'new'
          - '2025-10-19'
          - '2025-09-30'
          - '2025-10-15'
      repo_settings:
        description: "unless/iStoreOS-Actions"
        required: true
        default: "unless/iStoreOS-Actions"
        
env:
  VERSION: 24.10.3

jobs:
  build:
    runs-on: ubuntu-22.04
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
  notify-webhook:
    name: '📢 Webhook通知'
    runs-on: ubuntu-latest
    steps:
      - name: 发送Webhook通知
        run: |
        
          # 构建通知消息
          MESSAGE="工作流状态: ${{ job.status }}<br>"
          MESSAGE+="工作流名称: ${{ github.workflow }}<br>"
          MESSAGE+="运行ID: ${{ github.run_id }}\n"
          MESSAGE+="触发事件: ${{ github.event_name }}<br>"
          MESSAGE+="提交: ${{ github.sha }}\n"
          MESSAGE+="详情: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}"

          # 发送到Webhook
          curl -X POST \
            -H "Content-Type: application/json" \
            -d '{
              "content": "GitHub Actions 通知",
              "embeds": [{
                "title": "工作流完成通知",
                "description": "'"${MESSAGE}"'",
              }]
            }' \
            "${{ secrets.WEBHOOK_URL }}"
        env:
          WEBHOOK_URL: ${{ secrets.WEBHOOK_URL }}
